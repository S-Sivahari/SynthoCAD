<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SynthoCAD - AI-Powered CAD Generator</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <h1>üîß SynthoCAD</h1>
                <p class="tagline">AI-Powered CAD Generation Platform</p>
            </div>
            <div class="status-indicators">
                <div class="status-item" id="api-status">
                    <span class="status-dot"></span>
                    <span class="status-label">Backend</span>
                </div>
                <div class="status-item" id="freecad-status">
                    <span class="status-dot"></span>
                    <span class="status-label">FreeCAD</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Navigation Tabs -->
            <nav class="tabs">
                <button class="tab active" data-tab="generate">Generate</button>
                <button class="tab" data-tab="models">My Models</button>
                <button class="tab" data-tab="parameters">Parameters</button>
                <button class="tab" data-tab="cleanup">Cleanup</button>
                <button class="tab" data-tab="monitoring">Monitoring</button>
            </nav>

            <!-- Tab Content -->
            <div class="tab-content">
                <!-- Generate Tab -->
                <section id="generate-tab" class="tab-pane active">
                    <div class="card">
                        <h2>üé® Generate from Natural Language</h2>
                        <p class="card-description">Describe your CAD model in plain English</p>
                        
                        <div class="form-group">
                            <label for="prompt-input">Enter your design description:</label>
                            <textarea 
                                id="prompt-input" 
                                rows="4" 
                                placeholder="e.g., Create a cylinder with 20mm diameter and 50mm height"
                            ></textarea>
                        </div>

                        <div class="form-group checkbox-group">
                            <label>
                                <input type="checkbox" id="open-freecad-prompt" checked>
                                Open in FreeCAD automatically
                            </label>
                        </div>

                        <div class="button-group">
                            <button id="validate-prompt-btn" class="btn btn-secondary">
                                Validate Prompt
                            </button>
                            <button id="generate-from-prompt-btn" class="btn btn-primary">
                                Generate Model
                            </button>
                        </div>

                        <div id="prompt-result" class="result-box" style="display: none;"></div>
                    </div>

                    <div class="card" style="margin-top: 20px;">
                        <h2>üìÑ Generate from JSON</h2>
                        <p class="card-description">Upload or paste SCL JSON schema</p>
                        
                        <div class="form-group">
                            <label for="json-input">SCL JSON:</label>
                            <textarea 
                                id="json-input" 
                                rows="8" 
                                placeholder='{"final_name": "MyPart", "final_shape": "cylinder", ...}'
                            ></textarea>
                        </div>

                        <div class="form-group">
                            <label for="output-name-input">Output Name (optional):</label>
                            <input type="text" id="output-name-input" placeholder="my_custom_part">
                        </div>

                        <div class="form-group checkbox-group">
                            <label>
                                <input type="checkbox" id="open-freecad-json" checked>
                                Open in FreeCAD automatically
                            </label>
                        </div>

                        <div class="button-group">
                            <button id="load-json-file-btn" class="btn btn-secondary">
                                Load JSON File
                            </button>
                            <button id="generate-from-json-btn" class="btn btn-primary">
                                Generate Model
                            </button>
                        </div>

                        <input type="file" id="json-file-input" accept=".json" style="display: none;">
                        <div id="json-result" class="result-box" style="display: none;"></div>
                    </div>

                    <!-- Quick Examples -->
                    <div class="card examples-card">
                        <h3>üí° Quick Examples</h3>
                        <div class="examples-grid">
                            <button class="example-btn" data-example="cylinder">
                                Cylinder<br><small>20mm √ó 50mm</small>
                            </button>
                            <button class="example-btn" data-example="box">
                                Box<br><small>50 √ó 30 √ó 10mm</small>
                            </button>
                            <button class="example-btn" data-example="tube">
                                Tube<br><small>30mm OD, 5mm thick</small>
                            </button>
                            <button class="example-btn" data-example="bracket">
                                L-Bracket<br><small>50 √ó 50mm</small>
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Models Tab -->
                <section id="models-tab" class="tab-pane">
                    <div class="card">
                        <div class="card-header">
                            <h2>üìÅ Generated Models</h2>
                            <button id="refresh-models-btn" class="btn btn-secondary">
                                Refresh
                            </button>
                        </div>
                        
                        <div class="search-box">
                            <input type="text" id="model-search" placeholder="Search models...">
                        </div>

                        <div id="models-list" class="models-list">
                            <div class="loading">Loading models...</div>
                        </div>
                    </div>

                    <div class="card" style="margin-top: 20px;">
                        <h2>üîß FreeCAD Viewer</h2>
                        <div class="form-group">
                            <label for="step-file-input">STEP File Name:</label>
                            <input type="text" id="step-file-input" placeholder="output.step">
                        </div>
                        <div class="button-group">
                            <button id="open-freecad-btn" class="btn btn-primary">
                                Open in FreeCAD
                            </button>
                            <button id="reload-freecad-btn" class="btn btn-secondary">
                                Reload
                            </button>
                        </div>
                        <div id="freecad-result" class="result-box" style="display: none;"></div>
                    </div>
                </section>

                <!-- Parameters Tab -->
                <section id="parameters-tab" class="tab-pane">
                    <div class="card">
                        <h2>‚öôÔ∏è Parameter Editor</h2>
                        <p class="card-description">Extract and modify parameters from generated models</p>
                        
                        <div class="form-group">
                            <label for="param-file-input">Python File Name:</label>
                            <input type="text" id="param-file-input" placeholder="output_generated.py">
                        </div>

                        <button id="extract-params-btn" class="btn btn-primary">
                            Extract Parameters
                        </button>

                        <div id="parameters-container" style="display: none; margin-top: 20px;">
                            <div class="card-header">
                                <h3>Extracted Parameters</h3>
                                <span id="param-count" class="badge">0</span>
                            </div>
                            <div id="parameters-list" class="parameters-list"></div>
                            
                            <div class="form-group checkbox-group" style="margin-top: 15px;">
                                <label>
                                    <input type="checkbox" id="open-freecad-regen" checked>
                                    Open in FreeCAD after regeneration
                                </label>
                            </div>

                            <div class="button-group">
                                <button id="update-params-btn" class="btn btn-secondary">
                                    Update Only
                                </button>
                                <button id="regenerate-btn" class="btn btn-primary">
                                    Update & Regenerate
                                </button>
                            </div>
                        </div>

                        <div id="param-result" class="result-box" style="display: none;"></div>
                    </div>
                </section>

                <!-- Cleanup Tab -->
                <section id="cleanup-tab" class="tab-pane">
                    <div class="card">
                        <h2>üßπ Storage Management</h2>
                        
                        <div id="storage-stats" class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-value" id="total-files">-</div>
                                <div class="stat-label">Total Files</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="total-size">-</div>
                                <div class="stat-label">Total Size</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="json-files">-</div>
                                <div class="stat-label">JSON Files</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="py-files">-</div>
                                <div class="stat-label">Python Files</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="step-files">-</div>
                                <div class="stat-label">STEP Files</div>
                            </div>
                        </div>

                        <button id="refresh-stats-btn" class="btn btn-secondary" style="margin-top: 15px;">
                            Refresh Statistics
                        </button>
                    </div>

                    <div class="card" style="margin-top: 20px;">
                        <h2>Cleanup Options</h2>
                        
                        <div class="cleanup-options">
                            <div class="form-group">
                                <label for="cleanup-age">Delete files older than (days):</label>
                                <input type="number" id="cleanup-age" value="30" min="1">
                            </div>

                            <div class="form-group">
                                <label for="cleanup-count">Keep only most recent files:</label>
                                <input type="number" id="cleanup-count" value="100" min="1">
                            </div>

                            <div class="form-group checkbox-group">
                                <label>
                                    <input type="checkbox" id="cleanup-dry-run" checked>
                                    Dry Run (preview only, don't delete)
                                </label>
                            </div>
                        </div>

                        <div class="button-group">
                            <button id="cleanup-by-age-btn" class="btn btn-warning">
                                Cleanup by Age
                            </button>
                            <button id="cleanup-by-count-btn" class="btn btn-warning">
                                Cleanup by Count
                            </button>
                            <button id="cleanup-all-btn" class="btn btn-danger">
                                Full Cleanup
                            </button>
                        </div>

                        <div id="cleanup-result" class="result-box" style="display: none;"></div>
                    </div>

                    <div class="card" style="margin-top: 20px;">
                        <h2>Delete Specific Model</h2>
                        <div class="form-group">
                            <label for="delete-model-name">Model Name:</label>
                            <input type="text" id="delete-model-name" placeholder="my_cylinder">
                        </div>
                        <button id="delete-model-btn" class="btn btn-danger">
                            Delete Model
                        </button>
                        <div id="delete-result" class="result-box" style="display: none;"></div>
                    </div>
                </section>

                <!-- Monitoring Tab -->
                <section id="monitoring-tab" class="tab-pane">
                    <div class="card">
                        <h2>üìä System Monitoring</h2>
                        
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-value" id="success-rate">-</div>
                                <div class="stat-label">Success Rate</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="total-operations">-</div>
                                <div class="stat-label">Total Operations</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="avg-attempts">-</div>
                                <div class="stat-label">Avg Attempts</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="failed-ops">-</div>
                                <div class="stat-label">Failed Operations</div>
                            </div>
                        </div>

                        <button id="refresh-monitoring-btn" class="btn btn-secondary" style="margin-top: 15px;">
                            Refresh Statistics
                        </button>
                    </div>

                    <div class="card" style="margin-top: 20px;">
                        <h2>Recent Operations</h2>
                        <div class="form-group">
                            <label for="operation-filter">Filter by operation:</label>
                            <select id="operation-filter">
                                <option value="">All Operations</option>
                                <option value="gemini_api_call">Gemini API Calls</option>
                                <option value="cadquery_execution">CadQuery Execution</option>
                            </select>
                        </div>
                        <div id="retry-history" class="retry-history">
                            <div class="loading">Loading history...</div>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>SynthoCAD v1.0 | Backend API: <span id="api-url">http://localhost:5000</span></p>
        </footer>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container"></div>

    <!-- Scripts -->
    <script src="js/api.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
